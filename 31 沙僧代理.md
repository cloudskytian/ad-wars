## 沙僧代理
通过代理的方式，可以拦截 url, 在 Android 手机上就是开启 VPN 服务。

## DNS 拦截
整个互联网通过 TCP/IP 协议族来通信，DNS 协议是其中重要的协议之一，负责域名解析。
域名是 IP 地址的代号。  
对于人类来说，字符构成的域名(taobao.com)，比 IP 地址(140.205.220.96)容易使用。  
域名解析系统(DNS)就负责将域名翻译为对应的IP地址。  
域名查询属于公共基础服务，公开、无需保密，而且 DNS 协议使用 UDP 协议，方便拦截和污染。

### 使用方法
#### 两种运行方式：
1. 全局模式(所有应用流量都走 VPN 代理：耗电/导致网络慢)
2. 白名单模式(只有添加的应用才走 VPN 代理)  
ps: 应用添加到列表 dns 拦截就生效，统一使用：「域名过滤规则」
#### 规则
1. 完整域名匹配(会阻断这个域名的所有请求，需要确认是广告域名)
2. 通配符 * (只支持最前面使用*)
```
googleads.g.doubleclick.net
googleads.g.doubleclick.net

//可以简写为
*.g.doubleclick.net

// 只支持 2/3/4 段的匹配
*.doubleclick.net // 3 段
*.g.doubleclick.net // 3 段
*.ads.g.doubleclick.net // 4 段
```
#### 制作规则
1. 开启「悬浮窗」
2. 勾选「显示Url」
3. 会显示所有的域名查询  
ps: 黄色是包含 ad/ads 关键字，很可能是广告


## 以下是还未完成的 HTTP/HTTPS 拦截
### 安装证书
目前几乎所有的应用都是使用 HTTPS 来传输数据，来保证安全性，所以默认情况下无法拦截 url。  

不过可以使用中间人攻击(Man-in-the-middle attack：MITM)方式，来拦截请求。  

而更严格的是，从 Android 7.0 之后，用户安装的 HTTPS CA 证书不被信任，所以需要把证书安装在系统证书。  

大多数手机都是 Android 7.0 以上，为了更好的使用，需要安装系统证书。

#### Magisk 模块: [Move Certificates](https://github.com/Magisk-Modules-Repo/movecert)
安装之后，重启会将用户安装的证书移动为系统证书。

### 系统证书目录
/system/etc/security/cacerts

### 添加应用
只会拦截添加的应用
### 添加规则
1. 完整 url 拦截(一般不用)
2. Url 中关键字拦截，通配符使用(.*)
3. host 域名拦截(一般不用), 可以使用 hosts 替换

### 悬浮窗会显示所有的 url
1. 红色的表示已经拦截
2. 黄色是包含 ad/ads 关键字，很可能是广告

### 出现没有网络
如果网络是正常的，那么就是证书问题。有写 App 会验证证书，不信任的就拒绝链接。

### 不支持的应用
1. 抖音